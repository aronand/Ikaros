name: "godot-ci"
on: push

defaults:
  run:
    working-directory: ./Ikaros

jobs:
  gdtoolkit:
    name: "gdtoolkit: gdformat and gdlint"
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: Scony/godot-gdscript-toolkit@master
      - run: gdformat --check core game
        if: always()
      - run: gdlint core game
        if: always()
  godot-check-scripts:
    name: "godot: check scripts"
    runs-on: ubuntu-latest
    container:
      image: aronand/godot-alpine:4.4-dev-7
    defaults:
      run:
        shell: ash {0}
    steps:
      - uses: actions/checkout@v4
      - name: Import project
        run: godot --headless --quit --import
      - name: Verify engine version
        run: godot --headless --quit --script scripts/verify_engine_version.gd
